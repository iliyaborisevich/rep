<!DOCTYPE html>
<html>
<head>
    <title>Лаб 9 - Асинхронность</title>
</head>
<body>
    <h3>Лабораторная работа 9 - Асинхронный JavaScript</h3>
    <p>F12 </p>
    
    <script>
      
        const delay = (ms) => new Promise(resolve => setTimeout(resolve, ms));
        
        async function task1() {
            console.log('Задача 1: начало');
            await delay(1000);
            console.log('Задача 1: завершена');
            return 'Результат 1';
        }
        
        async function task2() {
            console.log('Задача 2: начало');
            await delay(1500);
            console.log('Задача 2: завершена');
            return 'Результат 2';
        }
        
        async function task3() {
            console.log('Задача 3: начало');
            await delay(800);
            console.log('Задача 3: завершена');
            return 'Результат 3';
        }
        
        // Запуск задач последовательно
        async function runAllTasks() {
            console.log('\n--- Последовательный запуск ---');
            const r1 = await task1();
            const r2 = await task2();
            const r3 = await task3();
            console.log('Все задачи выполнены!');
           
        }
        
        
        async function getPosts() {
            try {
                console.log('Загружаем посты...');
                const response = await fetch('https://jsonplaceholder.typicode.com/posts');
                const posts = await response.json();
                
                console.log('Первые 10 заголовков постов:');
                posts.slice(0, 10).forEach((post, i) => {
                    console.log(`${i+1}. ${post.title}`);
                });
                
                return posts.length;
            } catch (error) {
                console.error('Ошибка:', error);
            }
        }
        
       
        
        async function getCurrency() {
            try {
                console.log('Получаем курсы валют...');
                
                // Используем работающий API
                const response = await fetch('https://api.exchangerate-api.com/v4/latest/USD');
                const data = await response.json();
                
                if (data && data.rates) {
                    console.log('Курсы валют к USD:');
                    console.log(`EUR: ${data.rates.EUR}`);
                    console.log(`RUB: ${data.rates.RUB}`);
                    console.log(`BYN: ${data.rates.BYN || 'Нет данных'}`);
                }
                
                return data;
            } catch (error) {
                console.error('Ошибка:', error);
                
                
            }
        }
        
        
        async function runAll() {
            
            
            // Задание 1
            await runAllTasks();
            
            // Задание 2
            const postsCount = await getPosts();
            
            
            // Задание 3
            await getCurrency();
            
            console.log('\n=== Все задания выполнены! ===');
        }
        
        // Автозапуск при загрузке страницы
        runAll();
        
    </script>
</body>
</html>